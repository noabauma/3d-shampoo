==15524== NVPROF is profiling process 15524, command: python megatron_3D.py --model-parallel-size 1 --pipe-parallel-size 1 --num-layers 1 --hidden-size 1024 --num-attention-heads 16 --seq-length 1024 --max-position-embeddings 1024 --batch-size 1 --gas 16 --data-path megatron/data/webtext/webtext_text_documen
==15524== Warning: Profiling results might be incorrect with current version of nvcc compiler used to compile cuda app. Compile with nvcc compiler 9.0 or later version to get correct profiling results. Ignore this warning if code is already compiled with the recommended nvcc version 
libibverbs: Could not locate libibgni (/usr/lib64/libibgni.so.1: undefined symbol: verbs_uninit_context)
libibverbs: Warning: couldn't open config directory '/opt/cray/rdma-core/27.1-7.0.3.1_4.6__g4beae6eb.ari/etc/libibverbs.d'.
Traceback (most recent call last):
  File "/users/bnoahand/noah_workspace/thesis_master/3d_parallelism/my_megatron_3D_parallelism/megatron_3D.py", line 296, in <module>
    assert cnt_precs == 64, f"number of prec matrices should be 64 but got {cnt_precs} for all parallelism"
AssertionError: number of prec matrices should be 64 but got 6144 for all parallelism
==15524== Profiling application: python megatron_3D.py --model-parallel-size 1 --pipe-parallel-size 1 --num-layers 1 --hidden-size 1024 --num-attention-heads 16 --seq-length 1024 --max-position-embeddings 1024 --batch-size 1 --gas 16 --data-path megatron/data/webtext/webtext_text_documen
==15524== Profiling result:
==15524== Metric result:
Invocations                               Metric Name                            Metric Description         Min         Max         Avg
Device "Tesla P100-PCIE-16GB (0)"
    Kernel: sgemm_32x32x32_NN_vec
     491520                             flop_count_sp   Floating Point Operations(Single Precision)      595456      595456      595456
    Kernel: _ZN2at6native90_GLOBAL__N__66_tmpxft_00003b23_00000000_13_DistributionUniform_compute_86_cpp1_ii_f2fea07d43distribution_elementwise_grid_stride_kernelIfLi4EZNS0_9templates4cuda21uniform_and_transformIffLm4EPNS_17CUDAGeneratorImplEZZZNS4_14uniform_kernelIS7_EEvRNS_18TensorIteratorBaseEddT_ENKUlvE_clEvENKUlvE2_clEvEUlfE_EEvSA_T2_T3_EUlP24curandStatePhilox4_32_10E0_ZNS1_27distribution_nullary_kernelIffLi4ES7_SJ_SE_EEvSA_SF_RKSG_T4_EUlifE_EEviNS_15PhiloxCudaStateET1_SF_
       6144                             flop_count_sp   Floating Point Operations(Single Precision)        2176        2176        2176
    Kernel: _ZN2at6native29vectorized_elementwise_kernelILi4EZZZNS0_22reciprocal_kernel_cudaERNS_18TensorIteratorBaseEENKUlvE_clEvENKUlvE2_clEvEUlfE_NS_6detail5ArrayIPcLi2EEEEEviT0_T1_
       6144                             flop_count_sp   Floating Point Operations(Single Precision)           5           5           5
    Kernel: void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::MulFunctor<float>>, at::detail::Array<char*, int=3>, OffsetCalculator<int=2, unsigned int, bool=0>, OffsetCalculator<int=1, unsigned int, bool=0>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, float, float, float, float, at::native::MulFunctor<float>, at::native::BinaryFunctor<float, float, float, at::native::MulFunctor<float>>)
      18432                             flop_count_sp   Floating Point Operations(Single Precision)        4096        4096        4096
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::BinaryFunctor<float, float, bool, at::native::CompareGTFunctor<float>>, at::detail::Array<char*, int=3>>(int, float, float)
     122880                             flop_count_sp   Floating Point Operations(Single Precision)           0           0           0
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float>>, at::detail::Array<char*, int=2>>(int, float, float)
     393216                             flop_count_sp   Floating Point Operations(Single Precision)           1        4096        2561
    Kernel: void dot_kernel<float, int=128, int=0, cublasDotParams<cublasGemvTensor<float const >, cublasGemvTensorStridedBatched<float>>>(float const )
     122880                             flop_count_sp   Floating Point Operations(Single Precision)         255         255         255
    Kernel: _ZN2at6native29vectorized_elementwise_kernelILi4EZNS0_86_GLOBAL__N__56_tmpxft_00002c89_00000000_13_PowKernel_compute_86_cpp1_ii_f13e48f9_1148229pow_tensor_scalar_kernel_implIffEEvRNS_18TensorIteratorBaseET0_EUlfE2_NS_6detail5ArrayIPcLi2EEEEEviS6_T1_
       6144                             flop_count_sp   Floating Point Operations(Single Precision)          60          62          60
    Kernel: void reduce_1Block_kernel<float, int=128, int=7, cublasGemvTensorStridedBatched<float>, cublasGemvTensor<float>, cublasGemvTensor<float>>(float const *, float, float, int, float const *, float, cublasGemvTensorStridedBatched<float>, float, cublasPointerMode_t, cublasLtEpilogue_t, cublasGemvTensorStridedBatched<biasType<floatvalue_type, float>::type const >)
     122880                             flop_count_sp   Floating Point Operations(Single Precision)          39          39          39
    Kernel: void at::native::unrolled_elementwise_kernel<at::native::FillFunctor<float>, at::detail::Array<char*, int=1>, OffsetCalculator<int=0, unsigned int, bool=0>, OffsetCalculator<int=1, unsigned int, bool=0>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, float, at::native::FillFunctor<float>, char*, int=1, at::detail::Array<char*, int=1>, int=0)
       6144                             flop_count_sp   Floating Point Operations(Single Precision)           0           0           0
    Kernel: void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::DivFunctor<float>>, at::detail::Array<char*, int=3>, OffsetCalculator<int=2, unsigned int, bool=0>, OffsetCalculator<int=1, unsigned int, bool=0>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, float, float, float, float, at::native::DivFunctor<float>, at::native::BinaryFunctor<float, float, float, at::native::DivFunctor<float>>)
     129024                             flop_count_sp   Floating Point Operations(Single Precision)         960         960         960
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareGTFunctor<float>>, at::detail::Array<char*, int=2>>(int, float, float)
     251904                             flop_count_sp   Floating Point Operations(Single Precision)           0           0           0
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float>>, at::detail::Array<char*, int=3>>(int, float, float)
     374784                             flop_count_sp   Floating Point Operations(Single Precision)           2        8192        5641
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::FillFunctor<float>, at::detail::Array<char*, int=1>>(int, float, at::native::FillFunctor<float>)
       6144                             flop_count_sp   Floating Point Operations(Single Precision)           0           0           0
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::AbsFunctor<float>, at::detail::Array<char*, int=2>>(int, float, at::native::AbsFunctor<float>)
     251904                             flop_count_sp   Floating Point Operations(Single Precision)           1        4096        2098
    Kernel: void at::native::vectorized_elementwise_kernel<int=4, at::native::BUnaryFunctor<float, float, float, at::native::AddFunctor<float>>, at::detail::Array<char*, int=2>>(int, float, float)
      12288                             flop_count_sp   Floating Point Operations(Single Precision)           2         128          65
    Kernel: void at::native::reduce_kernel<int=512, int=1, at::native::ReduceOp<float, at::native::NormTwoOps<float, float>, unsigned int, float, int=4>>(float)
     135168                             flop_count_sp   Floating Point Operations(Single Precision)         679       12775        1228
    Kernel: void gemv2T_kernel_val<int, int, float, float, float, float, int=128, int=16, int=2, int=2, bool=0, bool=0, cublasGemvParams<cublasGemvTensorStridedBatched<float const >, cublasGemvTensorStridedBatched<float const >, cublasGemvTensorStridedBatched<float>, float>>(float const , float, float)
     122880                             flop_count_sp   Floating Point Operations(Single Precision)       10688       10688       10688
    Kernel: void at::native::reduce_kernel<int=512, int=1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::MaxNanFunctor<float>>, unsigned int, float, int=4>>(float)
     129024                             flop_count_sp   Floating Point Operations(Single Precision)           0           0           0
======== Error: Application returned non-zero code 1
